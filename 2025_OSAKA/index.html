<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2025 京阪奈岡山之旅</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700&family=Shippori+Mincho:wght@400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --jp-white: #fcfcfc;
            --jp-black: #2b2b2b;
            --jp-indigo: #2e4b71; /* 藍鐵色 */
            --jp-red: #b94047;   /* 茜色 */
            --jp-matcha: #728c69; /* 抹茶色 */
            --jp-grey: #d4dcd6;   /* 白綠色 */
            --jp-bg: #f4f4f3;
        }
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--jp-bg);
            color: var(--jp-black);
            -webkit-tap-highlight-color: transparent;
        }
        .font-jp-serif {
            font-family: 'Shippori Mincho', serif;
        }
        .hide-scrollbar::-webkit-scrollbar {
            display: none;
        }
        .hide-scrollbar {
            -ms-overflow-style: none;
            scrollbar-width: none;
        }
        .card-shadow {
            box-shadow: 0 4px 20px rgba(0,0,0,0.03);
        }
        .nav-item.active {
            color: var(--jp-indigo);
            font-weight: 500;
        }
        .nav-item.active::after {
            content: '';
            display: block;
            width: 4px;
            height: 4px;
            background: var(--jp-indigo);
            border-radius: 50%;
            margin: 4px auto 0;
        }
        /* Tag Styles */
        .tag-must-eat { background: #fff5f5; color: #c53030; border: 1px solid #c53030; }
        .tag-must-buy { background: #f0fff4; color: #2f855a; border: 1px solid #2f855a; }
        .tag-tips { background: #ebf8ff; color: #2c5282; border: 1px solid #2c5282; }
    </style>
</head>
<body class="h-screen flex flex-col overflow-hidden">

    <header class="bg-white/90 backdrop-blur-sm pt-12 pb-4 px-6 fixed w-full top-0 z-50 card-shadow">
        <div class="flex justify-between items-end">
            <div>
                <p class="text-xs text-gray-500 tracking-widest mb-1">2025 SUMMER TRIP</p>
                <h1 class="text-2xl font-jp-serif font-bold text-[#2e4b71]">京阪奈・瀬戸内</h1>
            </div>
            <div id="weather-widget" class="text-right">
                <i class="fas fa-sun text-orange-400 text-xl"></i>
                <span class="text-sm font-medium ml-1">32°C</span>
                <p class="text-xs text-gray-400 mt-1">大阪市</p>
            </div>
        </div>
    </header>

    <main id="main-container" class="flex-1 overflow-y-auto pt-32 pb-24 px-4 hide-scrollbar">
        </main>

    <nav class="fixed bottom-0 w-full bg-white border-t border-gray-100 pb-safe pt-2 px-6 z-50">
        <div class="flex justify-between items-center h-16 max-w-md mx-auto">
            <button onclick="renderItinerary()" class="nav-item active flex-1 flex flex-col items-center text-gray-400">
                <i class="fas fa-map-marked-alt text-xl mb-1"></i>
                <span class="text-[10px]">行程</span>
            </button>
            <button onclick="renderTools()" class="nav-item flex-1 flex flex-col items-center text-gray-400">
                <i class="fas fa-suitcase text-xl mb-1"></i>
                <span class="text-[10px]">工具</span>
            </button>
            <button onclick="renderWallet()" class="nav-item flex-1 flex flex-col items-center text-gray-400">
                <i class="fas fa-wallet text-xl mb-1"></i>
                <span class="text-[10px]">預算</span>
            </button>
        </div>
    </nav>

    <script>
        // Data parsed from your Trello JSON
        const db = {
            flights: {
                outbound: { date: "2025/08/28", flight: "IT214", time: "11:30 - 15:05", route: "TPE ➝ OKJ (岡山)" },
                inbound: { date: "2025/09/05", flight: "IT215", time: "15:55 - 17:40", route: "KIX ➝ TPE (推測)" } // Assuming return based on date
            },
            cards: [
                { id: "credit", name: "信用卡攻略", desc: "大寶Cube(3%)、貝Gogoro(4%)、全支付(3.5-6%)" },
                { id: "pass", name: "JR Pass", desc: "關西廣域周遊券 (KWAP)" }
            ],
            itinerary: [
                {
                    day: "D1", date: "8/28 (四)", loc: "岡山・倉敷", weather: "sunny", temp: "33°",
                    events: [
                        { type: "transport", title: "飛往岡山", time: "11:30", desc: "台灣虎航 IT214, T1航廈", important: "環亞貴賓室(C區)" },
                        { type: "transport", title: "抵達岡山", time: "15:05", desc: "入境審查 VJW" },
                        { type: "sight", title: "移動至倉敷", desc: "Check-in 住宿", nav: "倉敷美觀地區" },
                        { type: "food", title: "倉敷晚餐", desc: "推薦：富來屋本舖 (千屋牛) 或 倉敷烏龍麵", tags: ["必吃"] }
                    ]
                },
                {
                    day: "D2", date: "8/29 (五)", loc: "倉敷・京都", weather: "cloud", temp: "31°",
                    events: [
                        { type: "transport", title: "移動：倉敷 ➝ 岡山 ➝ 新大阪", desc: "特急(10分) + 新幹線 Sakura/Hikari (50分)", important: "使用JR KWAP Pass" },
                        { type: "transport", title: "移動：新大阪 ➝ 京都", desc: "轉乘 JR新快速 (25分)", nav: "京都車站" },
                        { type: "sight", title: "京都/嵐山 散策", desc: "Check-in 京都住宿", nav: "嵐山" }
                    ]
                },
                {
                    day: "D3", date: "8/30 (六)", loc: "嵐山・龜岡", weather: "rain", temp: "29°",
                    events: [
                        { type: "sight", title: "保津川遊船", time: "09:00", desc: "龜岡上船，遊船至嵐山 (約2小時)", nav: "保津川下り乗船場", important: "預約代號確認" },
                        { type: "food", title: "嵐山午餐", desc: "推薦：廣川鰻魚飯 或 嵐山吉兆", tags: ["排隊名店"] },
                        { type: "sight", title: "嵐山散策", desc: "竹林小徑、野宮神社、天龍寺", nav: "竹林小徑" }
                    ]
                },
                {
                    day: "D4", date: "8/31 (日)", loc: "宇治", weather: "sunny", temp: "32°",
                    events: [
                        { type: "transport", title: "前往宇治", desc: "JR 奈良線 (快速約17分)", nav: "宇治站" },
                        { type: "sight", title: "平等院鳳凰堂", desc: "世界遺產，10円硬幣背景", nav: "平等院" },
                        { type: "food", title: "中村藤吉 本店", desc: "必點：生茶果凍 (排隊需時)", tags: ["必吃", "甜點"] }
                    ]
                },
                {
                    day: "D5", date: "9/01 (一)", loc: "小倉・任天堂", weather: "sunny", temp: "33°",
                    events: [
                        { type: "sight", title: "任天堂博物館", desc: "Nintendo Museum", nav: "Nintendo Museum", important: "檢查門票QR Code", tags: ["重點行程"] },
                        { type: "tips", title: "置物提醒", desc: "博物館有免費置物櫃(100円退幣式)" }
                    ]
                },
                {
                    day: "D6", date: "9/02 (二)", loc: "奈良", weather: "cloud", temp: "31°",
                    events: [
                        { type: "transport", title: "前往奈良", desc: "JR 大和路快速", nav: "JR奈良站" },
                        { type: "sight", title: "奈良公園 & 東大寺", desc: "餵鹿 (小心被咬屁股)", nav: "東大寺" },
                        { type: "food", title: "志津香釜飯", desc: "或是 中谷堂麻糬", tags: ["必吃"] }
                    ]
                },
                {
                    day: "D7", date: "9/03 (三)", loc: "USJ 環球影城", weather: "sunny", temp: "30°",
                    events: [
                        { type: "sight", title: "USJ Day 1", time: "08:00", desc: "提早排隊入園", nav: "Universal Studios Japan", tags: ["年票"] },
                        { type: "tips", title: "禁忌之旅", desc: "雖然刺激但會暈，建議飯前玩" }
                    ]
                },
                {
                    day: "D8", date: "9/04 (四)", loc: "USJ 環球影城", weather: "sunny", temp: "30°",
                    events: [
                        { type: "sight", title: "USJ Day 2", desc: "補玩昨天沒玩到的設施", nav: "Universal Studios Japan" }
                    ]
                },
                {
                    day: "D9", date: "9/05 (五)", loc: "大阪梅田", weather: "cloud", temp: "31°",
                    events: [
                        { type: "sight", title: "梅田購物", desc: "LUCUA, Grand Front, 阪急百貨", nav: "LUCUA osaka" },
                        { type: "transport", title: "前往機場", desc: "Haruka 或是 南海電鐵", nav: "Kansai International Airport" }
                    ]
                }
            ],
            luggage: ["酒精", "衛生紙", "香", "眼鏡/墨鏡", "塑膠袋(髒衣)", "睡衣", "襪子(3)", "內褲(3)", "行李束帶", "護照", "日幣", "行動電源", "手機繩", "鑰匙", "Cube卡", "Gogoro卡", "藥品(甲亢/頭痛/鼻)", "化妝包", "護墊/口罩", "卸妝棉", "洗面乳", "牙刷", "充電線", "iPad", "小豬衣物組"],
            links: {
                expenses: "https://docs.google.com/spreadsheets/d/1RFGLe_BHZ48Opw4kOvMXEwZN7tPvhE3jDTv_-iB6sdg/edit?usp=drivesdk",
                haruka: "https://www.instagram.com/reel/DIeF0H1TrAY/",
                usj_forecast: "https://usjreal.asumirai.info/monthly/usj-forecast-2025-9.html"
            }
        };

        const mainContainer = document.getElementById('main-container');

        // Initial Render
        renderItinerary();

        function setActiveNav(index) {
            document.querySelectorAll('.nav-item').forEach((el, i) => {
                if(i === index) {
                    el.classList.add('active');
                    el.classList.remove('text-gray-400');
                } else {
                    el.classList.remove('active');
                    el.classList.add('text-gray-400');
                }
            });
            window.scrollTo(0, 0);
        }

        function getIconByType(type) {
            switch(type) {
                case 'transport': return '<i class="fas fa-train text-gray-400 w-6 text-center"></i>';
                case 'sight': return '<i class="fas fa-torii-gate text-[#b94047] w-6 text-center"></i>';
                case 'food': return '<i class="fas fa-utensils text-[#728c69] w-6 text-center"></i>';
                case 'tips': return '<i class="fas fa-lightbulb text-yellow-500 w-6 text-center"></i>';
                default: return '<i class="fas fa-circle text-xs text-gray-300 w-6 text-center"></i>';
            }
        }

        // --- Render Functions ---

        function renderItinerary() {
            setActiveNav(0);
            let html = '';
            
            db.itinerary.forEach((day, index) => {
                let eventHtml = '';
                day.events.forEach(evt => {
                    // Logic for Navigation Button
                    let navBtn = evt.nav ? `<button onclick="window.open('https://www.google.com/maps/search/?api=1&query=${evt.nav}')" class="ml-auto text-xs bg-gray-100 hover:bg-gray-200 text-gray-600 px-3 py-1 rounded-full"><i class="fas fa-location-arrow mr-1"></i>導航</button>` : '';
                    
                    // Logic for Tags
                    let tagsHtml = '';
                    if(evt.tags) {
                        evt.tags.forEach(tag => {
                            let className = 'bg-gray-100 text-gray-600 border border-gray-200';
                            if(tag.includes('必吃')) className = 'tag-must-eat';
                            if(tag.includes('重點')) className = 'tag-must-buy';
                            tagsHtml += `<span class="text-[10px] px-2 py-0.5 rounded ${className} mr-1">${tag}</span>`;
                        });
                    }

                    // Important Text Highlight
                    let importantHtml = evt.important ? `<div class="mt-1 text-xs text-[#b94047] font-medium"><i class="fas fa-exclamation-circle mr-1"></i>${evt.important}</div>` : '';

                    eventHtml += `
                        <div class="flex items-start mb-6 last:mb-0 relative">
                            <div class="mt-1 mr-3">${getIconByType(evt.type)}</div>
                            <div class="flex-1 pb-4 border-b border-gray-100 last:border-0">
                                <div class="flex justify-between items-start">
                                    <h4 class="font-medium text-gray-800">${evt.title}</h4>
                                    ${navBtn}
                                </div>
                                ${evt.time ? `<div class="text-xs text-gray-400 mb-1 font-mono">${evt.time}</div>` : ''}
                                <p class="text-sm text-gray-600 mt-1 leading-relaxed">${evt.desc}</p>
                                ${importantHtml}
                                <div class="mt-2">${tagsHtml}</div>
                            </div>
                        </div>
                    `;
                });

                html += `
                    <div class="bg-white rounded-2xl p-6 mb-6 card-shadow relative overflow-hidden">
                        <div class="flex justify-between items-center mb-6 border-b border-gray-100 pb-4">
                            <div>
                                <h3 class="text-2xl font-jp-serif font-bold text-gray-800">${day.day} <span class="text-sm font-sans font-normal text-gray-500 ml-2">${day.date}</span></h3>
                                <p class="text-sm text-[#2e4b71] font-medium mt-1"><i class="fas fa-map-marker-alt mr-1"></i>${day.loc}</p>
                            </div>
                            <div class="text-center bg-gray-50 px-3 py-2 rounded-lg">
                                <i class="fas ${day.weather === 'sunny' ? 'fa-sun text-orange-400' : day.weather === 'rain' ? 'fa-cloud-rain text-blue-400' : 'fa-cloud text-gray-400'} text-xl block mb-1"></i>
                                <span class="text-xs font-bold text-gray-600">${day.temp}</span>
                            </div>
                        </div>
                        <div>${eventHtml}</div>
                    </div>
                `;
            });
            
            // Add extra space at bottom
            html += `<div class="text-center text-xs text-gray-300 py-4">Have a nice trip!</div>`;
            mainContainer.innerHTML = html;
        }

        function renderTools() {
            setActiveNav(1);
            
            // Luggage List HTML
            let luggageHtml = db.luggage.map(item => `
                <label class="flex items-center p-3 border-b border-gray-50 last:border-0">
                    <input type="checkbox" class="w-4 h-4 text-[#2e4b71] rounded border-gray-300 focus:ring-[#2e4b71]">
                    <span class="ml-3 text-sm text-gray-700">${item}</span>
                </label>
            `).join('');

            mainContainer.innerHTML = `
                <div class="bg-white rounded-2xl p-6 mb-4 card-shadow border-l-4 border-[#2e4b71]">
                    <h3 class="text-lg font-bold text-gray-800 mb-4"><i class="fas fa-plane-departure mr-2 text-[#2e4b71]"></i>航班資訊</h3>
                    <div class="flex justify-between mb-4">
                        <div>
                            <div class="text-xs text-gray-400">去程 ${db.flights.outbound.date}</div>
                            <div class="text-xl font-bold font-mono text-gray-800">${db.flights.outbound.flight}</div>
                        </div>
                        <div class="text-right">
                             <div class="text-xs text-gray-400">Time</div>
                             <div class="text-sm font-medium">${db.flights.outbound.time}</div>
                        </div>
                    </div>
                    <div class="text-sm text-gray-600 bg-gray-50 p-2 rounded text-center">${db.flights.outbound.route}</div>
                    
                    <div class="border-t border-dashed border-gray-200 my-4"></div>

                    <div class="flex justify-between">
                        <div>
                            <div class="text-xs text-gray-400">回程 ${db.flights.inbound.date}</div>
                            <div class="text-xl font-bold font-mono text-gray-800">${db.flights.inbound.flight}</div>
                        </div>
                        <div class="text-right">
                             <div class="text-xs text-gray-400">Time</div>
                             <div class="text-sm font-medium">${db.flights.inbound.time}</div>
                        </div>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-4 mb-4">
                     <a href="${db.links.haruka}" target="_blank" class="bg-white p-4 rounded-xl card-shadow text-center active:scale-95 transition-transform">
                        <i class="fab fa-instagram text-pink-600 text-2xl mb-2"></i>
                        <div class="text-sm font-medium">Haruka 教學</div>
                    </a>
                     <a href="${db.links.usj_forecast}" target="_blank" class="bg-white p-4 rounded-xl card-shadow text-center active:scale-95 transition-transform">
                        <i class="fas fa-users text-blue-500 text-2xl mb-2"></i>
                        <div class="text-sm font-medium">USJ 人數預測</div>
                    </a>
                </div>

                <div class="bg-white rounded-2xl card-shadow overflow-hidden">
                    <div class="bg-[#2e4b71] px-6 py-4 text-white flex justify-between items-center">
                        <h3 class="font-bold"><i class="fas fa-tasks mr-2"></i>行李清單</h3>
                        <span class="text-xs opacity-70">記得檢查</span>
                    </div>
                    <div class="p-2 max-h-80 overflow-y-auto">
                        ${luggageHtml}
                    </div>
                </div>
            `;
        }

        function renderWallet() {
            setActiveNav(2);
            mainContainer.innerHTML = `
                 <div class="bg-white rounded-2xl p-8 mb-6 card-shadow text-center">
                    <p class="text-gray-400 text-sm mb-2">本次旅行總預算</p>
                    <h2 class="text-4xl font-bold text-gray-800 font-mono mb-6">¥ 200,000</h2>
                    <a href="${db.links.expenses}" target="_blank" class="block w-full bg-[#2e4b71] text-white py-3 rounded-xl font-medium shadow-lg shadow-indigo-200 active:bg-[#1a2e47]">
                        <i class="fas fa-external-link-alt mr-2"></i>開啟記帳表 (Google Sheets)
                    </a>
                </div>

                <div class="bg-white rounded-2xl p-6 mb-6 card-shadow">
                    <h3 class="font-bold text-gray-800 mb-4 border-l-4 border-[#b94047] pl-3">支付策略</h3>
                    
                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-1">
                            <span class="font-medium text-gray-700">大寶 Cube 卡</span>
                            <span class="text-xs bg-red-100 text-red-600 px-2 py-0.5 rounded">3%</span>
                        </div>
                        <p class="text-xs text-gray-500">訂房、Klook、海外實體消費 (切換趣旅行)</p>
                    </div>

                    <div class="mb-4">
                        <div class="flex justify-between items-center mb-1">
                            <span class="font-medium text-gray-700">貝 Gogoro 卡</span>
                            <span class="text-xs bg-green-100 text-green-600 px-2 py-0.5 rounded">4%</span>
                        </div>
                        <p class="text-xs text-gray-500">海外實體消費、線上刷外幣</p>
                    </div>

                    <div>
                        <div class="flex justify-between items-center mb-1">
                            <span class="font-medium text-gray-700">全支付</span>
                            <span class="text-xs bg-blue-100 text-blue-600 px-2 py-0.5 rounded">3.5%~6%</span>
                        </div>
                        <p class="text-xs text-gray-500">PayPay 掃碼 (便利商店、藥妝店)</p>
                    </div>
                </div>
            `;
        }

        // Simple weather randomizer simulation for visual effect
        // In a real app, you'd fetch API data
        const temps = ["30°C", "32°C", "29°C", "33°C"];
        const icons = ["fa-sun", "fa-cloud-sun", "fa-cloud"];
        const tempEl = document.querySelector('#weather-widget span');
        const iconEl = document.querySelector('#weather-widget i');
        
        // Update header weather randomly on load
        tempEl.innerText = temps[Math.floor(Math.random() * temps.length)];
        // iconEl... logic omitted for simplicity
    </script>
</body>
</html>